<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<title>OnOff</title>
	<meta name="description" content="Stupid program to toggle graphic points on/off">
	<!--[if lt IE 9]>
		<script src="//html5shiv.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
		<![endif]-->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
		integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
	<link rel="stylesheet" href="BRoys.css">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.min.js"></script>
</head>

<style>
</style>

<header class="br-alt-background">
	<img src="home.jpg" alt="Go to the brianroys.com home page" title="Go to brianroys.com home page." width="50px;"
		height="50px;" onclick="document.location='index.html';return false;" style="vertical-align: middle;" />
	<img src="pageicon.png" title="The story behind this page." onclick="$('#storyPage').modal({ keyboard: false });"
		style="vertical-align: middle;">
</header>

<body>
	<div>
		<p>
			<button class="btn btn-primary" onclick="RunOffOn();">Go!</button>
		</p>
		<p id="Screen">
		</p>
		<p>
			<span id="pct"></span>
		</p>
	</div>
	<div class="modal" id="storyPage" tabindex="-1" role="dialog">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">The History of the XYZGraph.</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<p>
						Back around 1985 we had just made the jump from COBOL to C and were having a blast writing tools
						and games
						and toys.
						One I wrote just randomly toggled pixels on and off. I knew intuitively that while it started
						out blank, it
						would
						fill the screen then settle down and hover with around 50% coverage. I'm sure there is a
						mathmatical proof but "at a greater than 50% full the odds of hitting an ON pixel are greater
						than 50%" is
						all I can
						articulate.
					</p>
					<p>
						Turns out this little program is <i>multi-threaded!</i> The more times you click the Go button
						the more
						processes run.
						And that is just fine.
					</p>

				</div>
			</div>
		</div>
	</div>
	<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
		integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
		integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
		integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
		crossorigin="anonymous"></script>

</body>
</html>

<script>
	var NRows = 24;
	var NCols = 80;
	var Rows;

	function ClearScreen() {
		Rows = Array(NRows);
		for (i = 0; i < NRows; ++i) {
			Rows[i] = Array(NCols);
			for (j = 0; j < NCols; ++j) {
				Rows[i][j] = 0;
			}
		}
	}

	function DisplayScreen() {
		var StrOut = "";
		var ons = 0;
		var offs = 0;
		for (i = 0; i < NRows; ++i) {
			for (j = 0; j < NCols; ++j) {
				var onoff = (Rows[i][j] == 0)
				if (onoff) {
					offs++;
				}
				else {
					ons++;
				}
				StrOut += onoff ? '&nbsp;' : '█';
			}
			StrOut += "</br>"
		}

		$("#Screen").html(StrOut);
		var pct = Math.trunc(ons / (ons + offs) * 100);
		$("#pct").html("Coverage: (" + ons + ":" + offs + ") " + pct + "%");
	}

	async function RunOffOn() {
		ClearScreen();
		while (true) {

			i = Math.trunc(Math.random() * NRows);
			j = Math.trunc(Math.random() * NCols);

			Rows[i][j] = 1 - Rows[i][j];

			DisplayScreen();

			// This is the magical incantation to allow the UI to update within the loop.
			await new Promise(resolve => setTimeout(resolve, 10)); // Wait for x/1000th of a second
		}
	}

	ClearScreen();
	DisplayScreen();

</script>